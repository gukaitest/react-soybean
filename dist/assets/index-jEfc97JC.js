import{_ as i,k as e,l as K,B as I,y as W,r as F,aN as Q,aO as $,aP as J}from"./index-BA7W61Th.js";import{u as Z}from"./useRequest-D5aHc4rj.js";import{i as ee,R as c,m as ae,a as ne,e as se,u as te,b as le,c as re,T as oe,F as ie,d as ce,f as me,P as ue}from"./TableHeaderOperation-De5kOUSX.js";import{f as de,a as pe}from"./system-manage-DaA6QwHC.js";import{S as ge}from"./index-kWxUwRvy.js";import{C as l,R as he}from"./row-Eb8ogRv3.js";import{F as s}from"./index-BnJL6rKO.js";import{I as j}from"./index-CBCmmzTk.js";import{S as xe}from"./index-ChmbLDeT.js";import{u as je}from"./form-BSzh_rzb.js";import{M as ve}from"./index-DnBhq_sg.js";import{S as b}from"./index-DMbHjEvh.js";import{T as q}from"./index-CNG_QsN8.js";import{C as _e}from"./index-CRbhX80q.js";import{T as G}from"./index-D4xyM27J.js";import"./subscribeFocus-C0kbgqSh.js";import"./debounce-DMi07XbZ.js";import"./_baseGetTag-BMkVdEYU.js";import"./index-BykAnZC5.js";import"./tslib.es6-CwN1OpI9.js";import"./index-DWYXoqn-.js";import"./index-DHM7bRxY.js";import"./index-DH9h88Qm.js";import"./EllipsisOutlined-Tld8H_El.js";import"./PurePanel-EBpQ4Xmb.js";import"./useBreakpoint-B6geGxKW.js";import"./responsiveObserver-BB31uip5.js";import"./index-D9_c5Gyf.js";import"./index-BEImSPwJ.js";import"./SearchOutlined-BLs8YZXF.js";import"./use-loading-BnRq-ISL.js";import"./index-BZu-6YnL.js";function fe(){return Object.keys(Object.assign({"/src/assets/svg-icon/activity.svg":()=>i(()=>import("./activity-B4XY664I.js"),[]),"/src/assets/svg-icon/at-sign.svg":()=>i(()=>import("./at-sign-DvqQw7Qx.js"),[]),"/src/assets/svg-icon/avatar.svg":()=>i(()=>import("./avatar-CR4D3Wln.js"),[]),"/src/assets/svg-icon/banner.svg":()=>i(()=>import("./banner-c0_1_hKZ.js"),[]),"/src/assets/svg-icon/cast.svg":()=>i(()=>import("./cast-n3EmpXB4.js"),[]),"/src/assets/svg-icon/chrome.svg":()=>i(()=>import("./chrome-BM_Le6p_.js"),[]),"/src/assets/svg-icon/copy.svg":()=>i(()=>import("./copy-BsYpLlfM.js"),[]),"/src/assets/svg-icon/custom-icon.svg":()=>i(()=>import("./custom-icon-857Ak5pp.js"),[]),"/src/assets/svg-icon/empty-data.svg":()=>i(()=>import("./empty-data-CzgJ8JYF.js"),[]),"/src/assets/svg-icon/error.svg":()=>i(()=>import("./error-BbzZSnrY.js"),[]),"/src/assets/svg-icon/expectation.svg":()=>i(()=>import("./expectation-BuEJD7SN.js"),[]),"/src/assets/svg-icon/heart.svg":()=>i(()=>import("./heart-DOH2U7VV.js"),[]),"/src/assets/svg-icon/logo.svg":()=>i(()=>import("./logo-BeLY4cv9.js"),[]),"/src/assets/svg-icon/network-error.svg":()=>i(()=>import("./network-error-BW-nao7Y.js"),[]),"/src/assets/svg-icon/no-icon.svg":()=>i(()=>import("./no-icon-DXySFfyH.js"),[]),"/src/assets/svg-icon/no-permission.svg":()=>i(()=>import("./no-permission-CtR3LTfG.js"),[]),"/src/assets/svg-icon/not-found.svg":()=>i(()=>import("./not-found-wOawdi8Z.js"),[]),"/src/assets/svg-icon/service-error.svg":()=>i(()=>import("./service-error-D3TuQMX7.js"),[]),"/src/assets/svg-icon/wind.svg":()=>i(()=>import("./wind-Dy5zdHKW.js"),[])})).map(m=>{var u;return((u=m.split("/").at(-1))==null?void 0:u.replace(".svg",""))||""}).filter(Boolean)}const Ie=a=>e.jsx("svg",{className:"inline-block",viewBox:"0 0 24 24",width:"1em",height:"1em",...a,children:e.jsx("path",{fill:"currentColor",d:"M18 13H6c-.55 0-1-.45-1-1s.45-1 1-1h12c.55 0 1 .45 1 1s-.45 1-1 1"})}),ye=({add:a,index:r,item:m,remove:u})=>{const{t:d}=K();function x(){u(r)}function _(){a("",r)}return e.jsxs("div",{className:"flex gap-3",children:[e.jsx(l,{span:9,children:e.jsx(s.Item,{name:[m.name,"key"],children:e.jsx(j,{className:"flex-1",placeholder:d("page.manage.menu.form.queryKey")})})}),e.jsx(l,{span:9,children:e.jsx(s.Item,{name:[m.name,"value"],children:e.jsx(j,{className:"flex-1",placeholder:d("page.manage.menu.form.queryValue")})})}),e.jsx(l,{span:5,children:e.jsxs(xe,{className:"ml-12px",children:[e.jsx(I,{icon:e.jsx(ee,{className:"align-sub text-icon"}),size:"middle",onClick:_}),e.jsx(I,{icon:e.jsx(Ie,{className:"align-sub text-icon"}),size:"middle",onClick:x})]})})]})},z="layout.",B="view.",be="$",Te=[{label:"base",value:"base"},{label:"blank",value:"blank"}];function Ne(a,r){return a&&!r.includes(a)&&r.unshift(a),r.map(u=>({label:u,value:u}))}function R(){return{activeMenu:null,buttons:[],component:"",constant:!1,fixedIndexInTab:null,hideInMenu:!1,href:null,i18nKey:null,icon:"",iconType:"1",keepAlive:!1,layout:"base",menuName:"",menuType:"1",multiTab:!1,order:0,page:"",parentId:0,pathParam:"",query:[],routeName:"",routePath:"",status:"1"}}function Pe(a){let r="",m="";const[u="",d=""]=(a==null?void 0:a.split(be))||[];return r=Oe(u),m=Ee(d||u),{layout:r,page:m}}function Oe(a){return a.startsWith(z)?a.replace(z,""):""}function Ee(a){return a.startsWith(B)?a.replace(B,""):""}function Re(a){const[r,m=""]=a.split("/:");return{param:m,path:r}}function ke(a,r){const m=[];function u(d){const x=d.i18nKey?r(d.i18nKey):d.menuName;m.push({label:x,value:d.id}),d.children&&Array.isArray(d.children)&&d.children.forEach(u)}return a.forEach(u),m}const Ae=a=>e.jsx("svg",{className:"inline-block",viewBox:"0 0 32 32",width:"1em",height:"1em",...a,children:e.jsx("path",{fill:"currentColor",d:"M17 15V8h-2v7H8v2h7v7h2v-7h7v-2z"})}),Le=fe(),Me=Le.map(a=>({label:e.jsxs("div",{className:"flex-y-center gap-16px",children:[e.jsx(W,{className:"text-icon",localIcon:a}),e.jsx("span",{children:a})]}),value:a})),we=({allPages:a,form:r,handleSubmit:m,menuList:u,onClose:d,open:x,operateType:_})=>{const{t:n}=K(),T={add:n("page.manage.menu.addMenu"),addChild:n("page.manage.menu.addChildMenu"),edit:n("page.manage.menu.editMenu")},{defaultRequiredRule:f}=je(),{hideInMenu:k,icon:N,iconType:A,menuType:L,parentId:M,routeName:w}=s.useWatch(o=>Object.assign(R(),o),{form:r,preserve:!0})||r.getFieldsValue(),D=L==="2",P=Number(M)===0,O=Ne(w,a),v={menuName:f,routeName:f,routePath:f,status:f};return e.jsx(ve,{open:x,title:T[_],width:"800px",onCancel:d,onOk:m,children:e.jsx("div",{className:"h-480px",children:e.jsx(ge,{children:e.jsx(s,{labelWrap:!0,className:"pr-20px",form:r,initialValues:R(),labelCol:{lg:8,xs:4},children:e.jsxs(he,{children:[e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.menuType"),name:"menuType",children:e.jsx(c.Group,{disabled:_==="edit",children:ae.map(o=>e.jsx(c,{value:o.value,children:n(o.label)},o.value))})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.menuName"),name:"menuName",rules:[v.menuName],children:e.jsx(j,{placeholder:n("page.manage.menu.form.menuName")})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.routeName"),name:"routeName",rules:[v.routeName],children:e.jsx(j,{placeholder:n("page.manage.menu.form.routeName")})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.routePath"),name:"routePath",rules:[v.routePath],children:e.jsx(j,{placeholder:n("page.manage.menu.form.routePath")})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.pathParam"),name:"pathParam",children:e.jsx(j,{placeholder:n("page.manage.menu.form.pathParam")})})}),P&&e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.layout"),name:"layout",children:e.jsx(b,{options:Te,placeholder:n("page.manage.menu.form.layout")})})}),!P&&e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.parent"),name:"parentId",children:e.jsx(b,{options:u,placeholder:n("page.manage.menu.form.parent")})})}),D&&e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.page"),name:"page",children:e.jsx(b,{options:O,placeholder:n("page.manage.menu.form.page")})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.i18nKey"),name:"i18nKey",children:e.jsx(j,{placeholder:n("page.manage.menu.form.i18nKey")})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.order"),name:"order",children:e.jsx(q,{className:"w-full",placeholder:n("page.manage.menu.form.order")})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.iconTypeTitle"),name:"iconType",children:e.jsx(c.Group,{children:ne.map(o=>e.jsx(c,{value:o.value,children:n(o.label)},o.value))})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.icon"),name:"icon",children:Number(A)===1?e.jsx(j,{className:"flex-1",placeholder:n("page.manage.menu.form.icon"),suffix:e.jsx(W,{className:"text-icon",icon:N})}):e.jsx(b,{allowClear:!0,options:Me,placeholder:n("page.manage.menu.form.localIcon")})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.menuStatus"),name:"status",rules:[v.status],children:e.jsx(c.Group,{children:se.map(o=>e.jsx(c,{value:o.value,children:n(o.label)},o.value))})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.keepAlive"),name:"keepAlive",children:e.jsxs(c.Group,{children:[e.jsx(c,{value:!0,children:n("common.yesOrNo.yes")}),e.jsx(c,{value:!1,children:n("common.yesOrNo.no")})]})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.constant"),name:"constant",children:e.jsxs(c.Group,{children:[e.jsx(c,{value:!0,children:n("common.yesOrNo.yes")}),e.jsx(c,{value:!1,children:n("common.yesOrNo.no")})]})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.href"),name:"href",children:e.jsx(j,{placeholder:n("page.manage.menu.form.href")})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.hideInMenu"),name:"hideInMenu",children:e.jsxs(c.Group,{children:[e.jsx(c,{value:!0,children:n("common.yesOrNo.yes")}),e.jsx(c,{value:!1,children:n("common.yesOrNo.no")})]})})}),k&&e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.activeMenu"),name:"activeMenu",children:e.jsx(b,{allowClear:!0,options:O,placeholder:n("page.manage.menu.form.activeMenu")})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.multiTab"),name:"multiTab",children:e.jsxs(c.Group,{children:[e.jsx(c,{value:!0,children:n("common.yesOrNo.yes")}),e.jsx(c,{value:!1,children:n("common.yesOrNo.no")})]})})}),e.jsx(l,{lg:12,xs:24,children:e.jsx(s.Item,{label:n("page.manage.menu.fixedIndexInTab"),name:"fixedIndexInTab",children:e.jsx(q,{className:"w-full",placeholder:n("page.manage.menu.form.fixedIndexInTab")})})}),e.jsx(l,{span:24,children:e.jsx(s.Item,{label:n("page.manage.menu.query"),labelCol:{span:4},children:e.jsx(s.List,{name:"query",children:(o,{add:E,remove:C})=>e.jsxs(e.Fragment,{children:[o.map(y=>e.jsx(ye,{add:E,index:o.findIndex(V=>V.key===y.key),item:y,remove:C},y.key)),o.length===0&&e.jsx(I,{block:!0,icon:e.jsx(Ae,{className:"align-sub text-icon"}),type:"dashed",onClick:()=>E("",0),children:e.jsx("span",{className:"ml-8px",children:n("common.add")})})]})})})})]})})})})})};function pa(){const{t:a}=K(),{scrollConfig:r,tableWrapperRef:m}=te(),{data:u}=Z(pe),{columnChecks:d,data:x,run:_,setColumnChecks:n,tableProps:T}=le({apiFn:de,columns:()=>[{align:"center",dataIndex:"id",key:"id",title:a("page.manage.menu.id")},{align:"center",key:"menuType",render:(g,t)=>{if(t.status===null)return null;const p={1:"default",2:"processing"},h=a(ce[t.menuType]);return e.jsx(G,{color:p[t.menuType],children:h})},title:a("page.manage.menu.menuType"),width:80},{align:"center",key:"menuName",minWidth:120,render:(g,t)=>{const{i18nKey:p,menuName:h}=t,S=p?a(p):h;return e.jsx("span",{children:S})},title:a("page.manage.menu.menuName")},{align:"center",key:"icon",render:(g,t)=>{const p=t.iconType==="1"?t.icon:void 0,h=t.iconType==="2"?t.icon:void 0;return e.jsx("div",{className:"flex-center",children:e.jsx(W,{className:"text-icon",icon:p,localIcon:h})})},title:a("page.manage.menu.icon"),width:60},{align:"center",dataIndex:"routeName",key:"routeName",minWidth:120,title:a("page.manage.menu.routeName")},{align:"center",dataIndex:"routePath",key:"routePath",minWidth:120,title:a("page.manage.menu.routePath")},{align:"center",dataIndex:"status",key:"status",render:(g,t)=>{if(t.status===null)return null;const p=a(me[t.status]);return e.jsx(G,{color:Q[t.status],children:p})},title:a("page.manage.menu.menuStatus"),width:80},{align:"center",dataIndex:"hideInMenu",key:"hideInMenu",render:(g,t)=>{const p=t.hideInMenu?"Y":"N",h=a($[p]);return e.jsx(G,{color:J[p],children:h})},title:a("page.manage.menu.hideInMenu"),width:80},{align:"center",dataIndex:"parentId",key:"parentId",title:a("page.manage.menu.parentId"),width:90},{align:"center",dataIndex:"order",key:"order",title:a("page.manage.menu.order"),width:60},{align:"center",key:"operate",render:(g,t,p)=>e.jsxs("div",{className:"flex-center justify-end gap-8px",children:[t.menuType==="1"&&e.jsx(I,{ghost:!0,size:"small",type:"primary",onClick:()=>V(t.id),children:a("page.manage.menu.addChildMenu")}),e.jsx(I,{size:"small",onClick:()=>y(t,p),children:a("common.edit")}),e.jsx(ue,{title:a("common.confirmDelete"),onConfirm:()=>C(t.id),children:e.jsx(I,{danger:!0,size:"small",children:a("common.delete")})})]}),title:a("common.operate"),width:195}]},{hideOnSinglePage:!0}),f=F.useMemo(()=>ke(x,a),[x,a]),{checkedRowKeys:k,generalPopupOperation:N,handleAdd:A,handleEdit:L,onBatchDeleted:M,onDeleted:w,openDrawer:D,rowSelection:P}=re(x,_,async(g,t)=>{}),[O,v]=F.useState("add");async function o(){M()}function E(){v("add"),A()}function C(g){w()}function y(g,t){const{component:p,...h}=g,{layout:S,page:H}=Pe(p),{param:Y,path:U}=Re(h.routePath),X=Object.assign(R(),h,{index:t,layout:S,page:H,pathParam:Y,routePath:U});L(X),v("edit")}function V(g){N.form.setFieldsValue(Object.assign(R(),{parentId:g})),v("addChild"),D()}return e.jsx("div",{className:"h-full min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto",children:e.jsxs(_e,{bordered:!1,className:"flex-col-stretch sm:flex-1-hidden card-wrapper",ref:m,title:a("page.manage.role.title"),extra:e.jsx(oe,{add:E,columns:d,disabledDelete:k.length===0,loading:T.loading,refresh:_,setColumnChecks:n,onDelete:o}),children:[e.jsx(ie,{rowSelection:P,scroll:r,size:"small",...T}),e.jsx(F.Suspense,{children:e.jsx(we,{...Object.assign(N,{operateType:O}),allPages:u||[],menuList:f||[]})})]})})}export{pa as Component};
